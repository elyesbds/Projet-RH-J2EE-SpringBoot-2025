<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Accueil - Gestion RH</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body class="home-page">
<!-- Sidebar -->
<div th:replace="~{fragments/sidebar :: sidebar}"></div>

<!-- Main content -->
<div class="content">
    <!-- Bouton de connexion/d√©connexion en haut √† droite -->
    <div class="header-auth">
        <div sec:authorize="isAuthenticated()">
                <span class="auth-status">
                    üë§ <span sec:authentication="name"></span>
                </span>
            <form th:action="@{/logout}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-logout">üö™ D√©connexion</button>
            </form>
        </div>
        <div sec:authorize="!isAuthenticated()">
            <a th:href="@{/login}" class="btn btn-login">üîê Se connecter</a>
        </div>
    </div>
    <!-- Message de bienvenue par d√©faut (affich√© uniquement si aucune section n'est active) -->
    <div th:if="${showEmployees == null or (!showEmployees and !showDashboard and !showStatistics and !showDepartements and !showProjets and !showFichesPaie)}" class="welcome-message">
        <h1>üè¢ Bienvenue dans le syst√®me de gestion RH</h1>
        <p>S√©lectionnez une option dans le menu de gauche pour commencer</p>
    </div>

    <!-- Section: Liste des employ√©s -->
    <div th:if="${showEmployees != null and showEmployees}">
        <div class="content-header">
            <h2>üìã Liste des employ√©s</h2>
        </div>

        <div class="header-actions">
            <a th:href="@{/employees}" class="btn btn-primary">
                ‚úèÔ∏è G√©rer les employ√©s (Ajouter/Modifier/Supprimer)
            </a>
        </div>

        <div th:if="${employees != null && !employees.isEmpty()}">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Matricule</th>
                    <th>Nom</th>
                    <th>Pr√©nom</th>
                    <th>Email</th>
                    <th>T√©l√©phone</th>
                    <th>Poste</th>
                    <th>Grade</th>
                    <th>Salaire</th>
                    <th>Date Embauche</th>
                    <th>D√©partement</th>
                    <th>Role</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="employee : ${employees}">
                    <td th:text="${employee.id}"></td>
                    <td th:text="${employee.matricule}"></td>
                    <td th:text="${employee.nom}"></td>
                    <td th:text="${employee.prenom}"></td>
                    <td th:text="${employee.email}"></td>
                    <td th:text="${employee.telephone}"></td>
                    <td th:text="${employee.poste}"></td>
                    <td th:text="${employee.grade}"></td>
                    <td th:text="${employee.salaireBase}"></td>
                    <td th:text="${employee.dateEmbauche}"></td>
                    <td th:text="${employee.idDepartement}"></td>
                    <td th:text="${employee.role}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${employees == null || employees.isEmpty()}" class="dashboard-card">
            <p style="text-align: center; color: #666;">Aucun employ√© trouv√© dans la base de donn√©es.</p>
        </div>
    </div>

    <!-- Section: Dashboard -->
    <div th:if="${showDashboard != null and showDashboard}">
        <div class="content-header">
            <h2>üìä Tableau de bord</h2>
        </div>

        <div class="dashboard-card">
            <h3>Nombre total d'employ√©s</h3>
            <div class="stat-number" th:text="${employeeCount}">0</div>
        </div>

        <div class="dashboard-card">
            <h3>Statistiques g√©n√©rales</h3>
            <p>Bienvenue sur votre tableau de bord. Vous pouvez visualiser ici les indicateurs cl√©s de votre entreprise.</p>
        </div>
    </div>

    <!-- Section: Statistiques -->
    <div th:if="${showStatistics != null and showStatistics}">
        <div class="content-header">
            <h2>üìà Statistiques</h2>
        </div>

        <div class="dashboard-card">
            <h3>Analyses d√©taill√©es</h3>
            <p>Section r√©serv√©e aux statistiques avanc√©es et aux rapports.</p>
        </div>
    </div>

    <!-- Section: Liste des d√©partements -->
    <div th:if="${showDepartements != null and showDepartements}">
        <div class="content-header">
            <h2>üèõÔ∏è Liste des d√©partements</h2>
        </div>

        <div class="header-actions">
            <a th:href="@{/departements}" class="btn btn-primary">
                ‚úèÔ∏è G√©rer les d√©partements (Ajouter/Modifier/Supprimer)
            </a>
        </div>

        <div th:if="${departements != null && !departements.isEmpty()}">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Intitul√©</th>
                    <th>Chef de d√©partement (ID)</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="departement : ${departements}">
                    <td th:text="${departement.id}"></td>
                    <td th:text="${departement.intitule}"></td>
                    <td th:text="${departement.chefDepartement}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${departements == null || departements.isEmpty()}" class="dashboard-card">
            <p style="text-align: center; color: #666;">Aucun d√©partement trouv√© dans la base de donn√©es.</p>
        </div>
    </div>

    <!-- Section: Liste des projets -->
    <div th:if="${showProjets != null and showProjets}">
        <div class="content-header">
            <h2>üìÅ Liste des projets</h2>
        </div>

        <div class="header-actions">
            <a th:href="@{/projets}" class="btn btn-primary">
                ‚úèÔ∏è G√©rer les projets (Ajouter/Modifier/Supprimer)
            </a>
        </div>

        <div th:if="${projets != null && !projets.isEmpty()}">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Nom du projet</th>
                    <th>√âtat</th>
                    <th>Date d√©but</th>
                    <th>Date fin pr√©vue</th>
                    <th>Chef de projet</th>
                    <th>D√©partement</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="projet : ${projets}">
                    <td th:text="${projet.id}"></td>
                    <td th:text="${projet.nomProjet}"></td>
                    <td th:text="${projet.etatProjet}"></td>
                    <td th:text="${projet.dateDebut}"></td>
                    <td th:text="${projet.dateFinPrevue}"></td>
                    <td>
                                <span th:if="${projet.chefProjet != null}">
                                    <span th:each="emp : ${employees}">
                                        <span th:if="${emp.id == projet.chefProjet}"
                                              th:text="${emp.prenom + ' ' + emp.nom}"></span>
                                    </span>
                                </span>
                        <span th:if="${projet.chefProjet == null}">-</span>
                    </td>
                    <td>
                                <span th:if="${projet.idDepartement != null}">
                                    <span th:each="dept : ${departements}">
                                        <span th:if="${dept.id == projet.idDepartement}"
                                              th:text="${dept.intitule}"></span>
                                    </span>
                                </span>
                        <span th:if="${projet.idDepartement == null}">-</span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${projets == null || projets.isEmpty()}" class="dashboard-card">
            <p style="text-align: center; color: #666;">Aucun projet trouv√© dans la base de donn√©es.</p>
        </div>
    </div>

    <!-- Section: Liste des fiches de paie -->
    <div th:if="${showFichesPaie != null and showFichesPaie}">
        <div class="content-header">
            <h2>üí∞ Liste des fiches de paie</h2>
        </div>

        <div class="header-actions">
            <a th:href="@{/fiches-paie}" class="btn btn-primary">
                ‚úèÔ∏è G√©rer les fiches de paie (Ajouter/Modifier/Supprimer)
            </a>
        </div>

        <div th:if="${fichesPaie != null && !fichesPaie.isEmpty()}">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Employ√©</th>
                    <th>P√©riode</th>
                    <th>Salaire base</th>
                    <th>Primes</th>
                    <th>D√©ductions</th>
                    <th>Net √† payer</th>
                    <th>Date g√©n√©ration</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="fiche : ${fichesPaie}">
                    <td th:text="${fiche.id}"></td>
                    <td>
                                <span th:if="${fiche.idEmployer != null}">
                                    <span th:each="emp : ${employees}">
                                        <span th:if="${emp.id == fiche.idEmployer}"
                                              th:text="${emp.prenom + ' ' + emp.nom}"></span>
                                    </span>
                                </span>
                        <span th:if="${fiche.idEmployer == null}">-</span>
                    </td>
                    <td th:text="${fiche.mois + '/' + fiche.annee}"></td>
                    <td th:text="${fiche.salaireBase + ' ‚Ç¨'}"></td>
                    <td th:text="${fiche.primes + ' ‚Ç¨'}"></td>
                    <td th:text="${fiche.deductions + ' ‚Ç¨'}"></td>
                    <td style="font-weight: bold; color: #4CAF50;" th:text="${fiche.netAPayer + ' ‚Ç¨'}"></td>
                    <td th:text="${fiche.dateGeneration}"></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${fichesPaie == null || fichesPaie.isEmpty()}" class="dashboard-card">
            <p style="text-align: center; color: #666;">Aucune fiche de paie trouv√©e dans la base de donn√©es.</p>
        </div>
    </div>
</div>
</body>
</html>