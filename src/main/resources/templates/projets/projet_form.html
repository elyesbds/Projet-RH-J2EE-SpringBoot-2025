<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire Projet</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body class="home-page">
<!-- Sidebar -->
<div th:insert="fragments/sidebar :: sidebar"></div>

<!-- Main content -->
<div class="content">
    <div class="form-container">
        <h1 th:text="${projet.id != null ? '‚úèÔ∏è Modifier un projet' : '‚ûï Ajouter un projet'}"></h1>

        <form id="projetForm" th:action="@{/projets/save}" th:object="${projet}" method="post" novalidate>
            <input type="hidden" th:field="*{id}">

            <div th:if="${#fields.hasErrors('global')}" class="alert alert-error">
                <p th:each="err : ${#fields.errors('global')}" th:text="${err}"></p>
            </div>

            <div class="form-group">
                <label for="nomProjet">Nom du projet <span class="required">*</span></label>
                <input type="text" id="nomProjet" name="nomProjet" th:field="*{nomProjet}"
                       th:classappend="${#fields.hasErrors('nomProjet')} ? 'error'"
                       required
                       minlength="3"
                       maxlength="150"
                       placeholder="Ex: Intranet RH, Migration Comptable...">
                <span class="error-message" th:if="${#fields.hasErrors('nomProjet')}"
                      th:errors="*{nomProjet}"></span>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="etatProjet">√âtat du projet <span class="required">*</span></label>
                    <select id="etatProjet" name="etatProjet" th:field="*{etatProjet}"
                            th:classappend="${#fields.hasErrors('etatProjet')} ? 'error'" required>
                        <option value="EN_COURS">‚è≥ En cours</option>
                        <option value="TERMINE">‚úÖ Termin√©</option>
                        <option value="ANNULE">‚ùå Annul√©</option>
                    </select>
                    <span class="error-message" th:if="${#fields.hasErrors('etatProjet')}"
                          th:errors="*{etatProjet}"></span>
                </div>

                <div class="form-group">
                    <label for="dateDebut">Date de d√©but <span class="required">*</span></label>
                    <input type="date" id="dateDebut" name="dateDebut" th:field="*{dateDebut}"
                           th:classappend="${#fields.hasErrors('dateDebut')} ? 'error'"
                           required
                           min="2020-01-01">
                    <span class="error-message" th:if="${#fields.hasErrors('dateDebut')}"
                          th:errors="*{dateDebut}"></span>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="dateFinPrevue">Date de fin pr√©vue</label>
                    <input type="date" id="dateFinPrevue" name="dateFinPrevue" th:field="*{dateFinPrevue}"
                           th:classappend="${#fields.hasErrors('dateFinPrevue')} ? 'error'">
                    <span class="error-message" th:if="${#fields.hasErrors('dateFinPrevue')}"
                          th:errors="*{dateFinPrevue}"></span>
                    <small class="field-hint">Doit √™tre apr√®s la date de d√©but</small>
                </div>

                <div class="form-group">
                    <label for="dateFinReelle">Date de fin r√©elle</label>
                    <input type="date" id="dateFinReelle" name="dateFinReelle" th:field="*{dateFinReelle}"
                           th:classappend="${#fields.hasErrors('dateFinReelle')} ? 'error'">
                    <span class="error-message" th:if="${#fields.hasErrors('dateFinReelle')}"
                          th:errors="*{dateFinReelle}"></span>
                    <small class="field-hint">√Ä renseigner quand le projet est termin√©</small>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="chefProjet">Chef de projet</label>
                    <select id="chefProjet" name="chefProjet" th:field="*{chefProjet}"
                            th:classappend="${#fields.hasErrors('chefProjet')} ? 'error'">
                        <option value="">-- S√©lectionner un chef de projet --</option>
                        <option th:each="emp : ${employees}"
                                th:value="${emp.id}"
                                th:text="${emp.prenom + ' ' + emp.nom + ' (' + emp.poste + ')'}">
                        </option>
                    </select>
                    <span class="error-message" th:if="${#fields.hasErrors('chefProjet')}"
                          th:errors="*{chefProjet}"></span>
                </div>

                <div class="form-group">
                    <label for="idDepartement">D√©partement</label>
                    <select id="idDepartement" name="idDepartement" th:field="*{idDepartement}"
                            th:classappend="${#fields.hasErrors('idDepartement')} ? 'error'">
                        <option value="">-- S√©lectionner un d√©partement --</option>
                        <option th:each="dept : ${departements}"
                                th:value="${dept.id}"
                                th:text="${dept.intitule}">
                        </option>
                    </select>
                    <span class="error-message" th:if="${#fields.hasErrors('idDepartement')}"
                          th:errors="*{idDepartement}"></span>
                </div>
            </div>

            <div class="btn-container">
                <a th:href="@{/projets}" class="btn btn-secondary">‚ùå Annuler</a>
                <button type="submit" class="btn btn-primary">üíæ Enregistrer</button>
            </div>
        </form>
    </div>
</div>

<script th:src="@{/js/form-validation.js}"></script>
</body>
</html>