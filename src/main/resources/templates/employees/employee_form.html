<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire Employ√©</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body class="form-page">
<div class="container">
    <h1 th:text="${employee.id != null ? '‚úèÔ∏è Modifier un employ√©' : '‚ûï Ajouter un employ√©'}"></h1>

    <form id="employeeForm" th:action="@{/employees/save}" th:object="${employee}" method="post" novalidate>
        <input type="hidden" th:field="*{id}">

        <div th:if="${#fields.hasErrors('global')}" class="alert alert-error">
            <p th:each="err : ${#fields.errors('global')}" th:text="${err}"></p>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="matricule">Matricule <span class="required">*</span></label>
                <input type="text" id="matricule" name="matricule" th:field="*{matricule}"
                       th:classappend="${#fields.hasErrors('matricule')} ? 'error'"
                       required
                       minlength="3"
                       maxlength="30"
                       placeholder="Ex: EMP001">
                <span class="error-message" th:if="${#fields.hasErrors('matricule')}"
                      th:errors="*{matricule}"></span>
            </div>

            <div class="form-group">
                <label for="poste">Poste <span class="required">*</span></label>
                <input type="text" id="poste" name="poste" th:field="*{poste}"
                       th:classappend="${#fields.hasErrors('poste')} ? 'error'"
                       required
                       minlength="3"
                       maxlength="100"
                       placeholder="Ex: D√©veloppeur, Comptable...">
                <span class="error-message" th:if="${#fields.hasErrors('poste')}"
                      th:errors="*{poste}"></span>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="nom">Nom <span class="required">*</span></label>
                <input type="text" id="nom" name="nom" th:field="*{nom}"
                       th:classappend="${#fields.hasErrors('nom')} ? 'error'"
                       required
                       minlength="2"
                       maxlength="50"
                       placeholder="Ex: Dupont">
                <span class="error-message" th:if="${#fields.hasErrors('nom')}"
                      th:errors="*{nom}"></span>
            </div>

            <div class="form-group">
                <label for="prenom">Pr√©nom <span class="required">*</span></label>
                <input type="text" id="prenom" name="prenom" th:field="*{prenom}"
                       th:classappend="${#fields.hasErrors('prenom')} ? 'error'"
                       required
                       minlength="2"
                       maxlength="50"
                       placeholder="Ex: Jean">
                <span class="error-message" th:if="${#fields.hasErrors('prenom')}"
                      th:errors="*{prenom}"></span>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="email">Email <span class="required">*</span></label>
                <input type="email" id="email" name="email" th:field="*{email}"
                       th:classappend="${#fields.hasErrors('email')} ? 'error'"
                       required
                       maxlength="100"
                       placeholder="prenom.nom@cy-rh.local">
                <span class="error-message" th:if="${#fields.hasErrors('email')}"
                      th:errors="*{email}"></span>
            </div>

            <div class="form-group">
                <label for="telephone">T√©l√©phone</label>
                <input type="tel" id="telephone" name="telephone" th:field="*{telephone}"
                       th:classappend="${#fields.hasErrors('telephone')} ? 'error'"
                       pattern="^(?:(?:\+|00)33|0)\s*[1-9](?:[\s.-]*\d{2}){4}$"
                       maxlength="20"
                       placeholder="0612345678">
                <span class="error-message" th:if="${#fields.hasErrors('telephone')}"
                      th:errors="*{telephone}"></span>
                <small class="field-hint">Format: 0612345678 ou +33612345678</small>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="grade">Grade <span class="required">*</span></label>
                <select id="grade" name="grade" th:field="*{grade}"
                        th:classappend="${#fields.hasErrors('grade')} ? 'error'"
                        required>
                    <option value="">-- S√©lectionner un grade --</option>
                    <option value="JUNIOR">Junior</option>
                    <option value="CONFIRME">Confirm√©</option>
                    <option value="SENIOR">Senior</option>
                    <option value="MANAGER">Manager</option>
                    <option value="DIRECTEUR">Directeur</option>
                </select>
                <span class="error-message" th:if="${#fields.hasErrors('grade')}"
                      th:errors="*{grade}"></span>
            </div>

            <div class="form-group">
                <label for="salaireBase">Salaire de base (‚Ç¨) <span class="required">*</span></label>
                <input type="number" id="salaireBase" name="salaireBase" th:field="*{salaireBase}"
                       th:classappend="${#fields.hasErrors('salaireBase')} ? 'error'"
                       required
                       step="0.01"
                       min="1000"
                       max="1000000"
                       placeholder="Ex: 2500.00">
                <span class="error-message" th:if="${#fields.hasErrors('salaireBase')}"
                      th:errors="*{salaireBase}"></span>
                <small class="field-hint">Minimum: 1000‚Ç¨</small>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="dateEmbauche">Date d'embauche <span class="required">*</span></label>
                <input type="date" id="dateEmbauche" name="dateEmbauche" th:field="*{dateEmbauche}"
                       th:classappend="${#fields.hasErrors('dateEmbauche')} ? 'error'"
                       required
                       min="1950-01-01"
                       th:max="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
                <span class="error-message" th:if="${#fields.hasErrors('dateEmbauche')}"
                      th:errors="*{dateEmbauche}"></span>
                <small class="field-hint">La date ne peut pas √™tre dans le futur</small>
            </div>

            <div class="form-group">
                <label for="idDepartement">D√©partement</label>
                <select id="idDepartement" name="idDepartement" th:field="*{idDepartement}"
                        th:classappend="${#fields.hasErrors('idDepartement')} ? 'error'">
                    <option value="">-- S√©lectionner un d√©partement --</option>
                    <option th:each="dept : ${departements}"
                            th:value="${dept.id}"
                            th:text="${dept.intitule}">
                    </option>
                </select>
                <span class="error-message" th:if="${#fields.hasErrors('idDepartement')}"
                      th:errors="*{idDepartement}"></span>
            </div>
        </div>

        <div class="form-group">
            <label for="role">R√¥le <span class="required">*</span></label>
            <select id="role" name="role" th:field="*{role}"
                    th:classappend="${#fields.hasErrors('role')} ? 'error'"
                    required>
                <option value="">-- S√©lectionner un r√¥le --</option>
                <option value="EMPLOYE">Employ√©</option>
                <option value="CHEF_PROJET">Chef de projet</option>
                <option value="CHEF_DEPT">Chef de d√©partement</option>
                <option value="ADMIN">Administrateur</option>
            </select>
            <span class="error-message" th:if="${#fields.hasErrors('role')}"
                  th:errors="*{role}"></span>
        </div>

        <div class="form-group">
            <label for="password">Mot de passe</label>
            <input type="password" id="password" name="password" th:field="*{password}"
                   th:classappend="${#fields.hasErrors('password')} ? 'error'"
                   minlength="6"
                   maxlength="255"
                   placeholder="Laissez vide pour ne pas modifier">
            <span class="error-message" th:if="${#fields.hasErrors('password')}"
                  th:errors="*{password}"></span>
            <small class="field-hint">Minimum 6 caract√®res (laissez vide pour ne pas modifier)</small>
        </div>

        <div class="btn-container">
            <a th:href="@{/employees}" class="btn btn-secondary">‚ùå Annuler</a>
            <button type="submit" class="btn btn-primary">üíæ Enregistrer</button>
        </div>
    </form>
</div>

<script th:src="@{/js/form-validation.js}"></script>
</body>
</html>